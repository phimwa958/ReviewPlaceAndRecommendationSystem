# เอกสารภาพรวมระบบ (System Overview)

## 1. ภาพรวม (Overview)

เอกสารนี้อธิบายโครงสร้างและฟังก์ชันการทำงานหลักของแอปพลิเคชันรีวิวสถานที่ ซึ่งสร้างขึ้นด้วยเฟรมเวิร์ก Django ระบบถูกออกแบบมาเป็นโมดูลต่างๆ ที่ทำงานร่วมกันเพื่อให้ผู้ใช้สามารถค้นหาสถานที่, อ่าน-เขียนรีวิว, และรับคำแนะนำที่ตรงกับความสนใจได้

แกนหลักของระบบประกอบด้วย:

*   **การจัดการผู้ใช้:** ระบบลงทะเบียน, เข้าสู่ระบบ, และจัดการโปรไฟล์ที่ปลอดภัย
*   **การจัดการเนื้อหา (CRUD):** การสร้าง, อ่าน, อัปเดต, และลบข้อมูลสำหรับ **สถานที่**, **รีวิว**, และ **ความคิดเห็น** พร้อมการจัดการสิทธิ์ที่ชัดเจน
*   **ระบบปฏิสัมพันธ์:** การกดไลค์, การแชร์, และการรายงานเนื้อหาที่ไม่เหมาะสม
*   **การติดตามพฤติกรรม:** บันทึกกิจกรรมสำคัญของผู้ใช้ (การดู, ค้นหา, คลิก, แชร์) เพื่อนำไปใช้วิเคราะห์และเป็นพื้นฐานให้ระบบแนะนำ
*   **ระบบแนะนำ:** นำเสนอสถานที่ที่น่าสนใจให้ผู้ใช้ ทั้งแบบส่วนตัวแบบยอดนิยมและตามความคล้ายคลึง
*   **ส่วนของผู้ดูแลระบบ:** แดชบอร์ดสำหรับวิเคราะห์ข้อมูลกิจกรรมในระบบในรูปแบบกราฟิกและตาราง

---

## 2. ระบบจัดการผู้ใช้และการยืนยันตัวตน (User Management & Authentication)

ส่วนนี้เป็นรากฐานของระบบ ทำให้สามารถระบุตัวตนผู้ใช้และจัดการข้อมูลส่วนตัวได้

### 2.1 Model ที่เกี่ยวข้อง: `CustomUser`

โมเดล `CustomUser` สืบทอด(inherits) มาจาก `AbstractUser` ของ Django เพื่อเพิ่มฟิลด์ข้อมูลเฉพาะ:
*   `mobile_phone`: เบอร์โทรศัพท์ (บังคับ, ไม่ซ้ำกัน)
*   `gender`: เพศ (ชาย, หญิง, อื่นๆ)
*   `date_of_birth`: วันเกิด
*   `profile_image`: รูปโปรไฟล์ (`ImageField`) ซึ่งมี `default='default.jpg'` สำหรับผู้ใช้ที่ยังไม่ได้อัปโหลดรูป
*   **`age` (Property):** เป็น property ที่คำนวณอายุของผู้ใช้จาก `date_of_birth` โดยอัตโนมัติ
*   **`clean()` (Method):** มีการ override method นี้เพื่อเพิ่มการตรวจสอบว่า `mobile_phone` ที่กรอกเข้ามาใหม่ไม่ซ้ำกับที่มีอยู่แล้วในระบบ

### 2.2 การลงทะเบียน (Registration)

*   **URL:** `/register/`
*   **View:** `RegisterView` (Class-Based View, สืบทอดจาก `CreateView`)
*   **Form:** `RegistrationForm` (สืบทอดจาก `forms.Form`)
*   **Template:** `review/form.html` (เทมเพลตกลาง)

**ขั้นตอนการทำงาน:**
1.  `RegisterView` ซึ่งเป็น `CreateView` ทำหน้าที่แสดง `RegistrationForm` ให้ผู้ใช้กรอกข้อมูล
2.  `RegistrationForm` (ซึ่งเป็น `forms.Form` ไม่ใช่ `ModelForm`) รับผิดชอบการตรวจสอบความถูกต้องของข้อมูล (Validation) ทั้งหมด:
    *   ตรวจสอบว่า `username`, `email`, และ `mobile_phone` ไม่เคยถูกใช้ในระบบ
    *   ตรวจสอบว่า `password` และ `confirm_password` ตรงกัน
    *   แปลงข้อมูล วัน/เดือน/ปี ที่รับเข้ามาเป็น `datetime` object ที่ถูกต้อง
3.  เมื่อผู้ใช้ส่งฟอร์มและข้อมูลถูกต้อง, `RegisterView` จะเรียก `form.save()` ซึ่งในที่นี้คือการสร้าง `CustomUser` object ใหม่จากข้อมูลใน `cleaned_data` และบันทึกลงฐานข้อมูลพร้อม hash รหัสผ่าน
4.  หลังจากสร้างผู้ใช้สำเร็จ ระบบจะทำการ `login()` ให้ผู้ใช้โดยอัตโนมัติและ redirect ไปยังหน้าแรก (`home`)

### 2.3 การเข้าสู่ระบบ (Login)

*   **URL:** `/login/`
*   **View:** `LoginView` (สืบทอดจาก `auth_views.LoginView` ของ Django)
*   **Template:** `review/form.html`

**ขั้นตอนการทำงาน:**
1.  ใช้ View มาตรฐานของ Django แต่มีการปรับปรุง `form_valid` เพื่อเพิ่มฟังก์ชัน "จดจำฉัน" (Remember Me) โดยจะตั้งค่า session expiry เป็น 2 สัปดาห์ (1,209,600 วินาที) หากผู้ใช้เลือก หรือตั้งเป็น 0 (หมดอายุเมื่อปิดเบราว์เซอร์) หากไม่ได้เลือก
2.  หากผู้ใช้เป็น Staff (`is_staff=True`) ระบบจะตั้งค่า session `redirect_to_admin` เพื่อใช้ในตรรกะอื่นๆ

### 2.4 การออกจากระบบ (Logout)

*   **URL:** `/logout/`
*   **View:** `LogoutView` (ใช้ `LogoutView` มาตรฐานของ Django)

### 2.5 การจัดการโปรไฟล์ (Profile Management)

ส่วนนี้ถูกแบ่งออกเป็น 3 Views หลักเพื่อการแสดงผลและแก้ไขข้อมูลที่ชัดเจน:

1.  **การแสดงผลโปรไฟล์ (`ProfileView`)**
    *   **URL:** `/profile/`
    *   **View:** `ProfileView` (สืบทอดจาก `DetailView`)
    *   **Template:** `review/profile.html`
    *   ทำหน้าที่แสดงข้อมูลส่วนตัวของผู้ใช้ที่ล็อกอินอยู่ (ชื่อ, รูปภาพ, อีเมล, ฯลฯ) และมีปุ่มลิงก์ไปยังหน้าแก้ไขโปรไฟล์และเปลี่ยนรหัสผ่าน

2.  **การแก้ไขโปรไฟล์ (`ProfileUpdateView`)**
    *   **URL:** `/profile/edit/`
    *   **View:** `ProfileUpdateView` (สืบทอดจาก `UpdateView`)
    *   **Form:** `UserUpdateForm` (`ModelForm` สำหรับ `CustomUser`)
    *   **Template:** `review/form.html`
    *   แสดงฟอร์มที่ผู้ใช้สามารถแก้ไข `first_name`, `last_name`, `email`, `mobile_phone`, และ `profile_image` ได้

3.  **การเปลี่ยนรหัสผ่าน (`CustomPasswordChangeView`)**
    *   **URL:** `/password/change/`
    *   **View:** `CustomPasswordChangeView` (สืบทอดจาก `PasswordChangeView`)
    *   **Form:** `PasswordUpdateForm`
    *   **Template:** `review/form.html`
    *   เป็นกระบวนการเปลี่ยนรหัสผ่านที่ปลอดภัย โดยผู้ใช้ต้องกรอกรหัสผ่านเก่าเพื่อยืนยันตัวตน

### 2.6 การรีเซ็ตรหัสผ่าน (Password Reset)

*   **URLs:** `/password_reset/`, `/password_reset/done/`, `/reset/<uidb64>/<token>/`, `/reset/done/`
*   ใช้กระบวนการรีเซ็ตรหัสผ่านที่เป็นมาตรฐานและปลอดภัยของ Django ทั้งหมด

---

## 3. การจัดการเนื้อหาหลัก (Core Content Management - CRUD)

ส่วนนี้อธิบายฟังก์ชัน CRUD สำหรับข้อมูลหลักของระบบ โดยมีการใช้ **Base Classes** และ **Mixins** เพื่อลดความซ้ำซ้อนและสร้างสถาปัตยกรรมที่นำกลับมาใช้ใหม่ได้

*   **`OwnerOrStaffRequiredMixin`:** Mixin ที่ใช้ตรวจสอบสิทธิ์ในการเข้าถึง View แก้ไข/ลบ โดยจะอนุญาตเฉพาะ **เจ้าของเนื้อหา** หรือ **ผู้ใช้ที่เป็น Staff** เท่านั้น
*   **`ImageHandlingMixin`:** Mixin ที่จัดการตรรกะการอัปโหลดรูปภาพหลายรูปสำหรับ `Place` และ `Review`
*   **`BaseDeleteView`:** View แม่แบบสำหรับหน้ายืนยันการลบทั้งหมด
*   **`BaseReportView`:** View แม่แบบสำหรับฟอร์มการรายงานทั้งหมด

### 3.1 การจัดการสถานที่ (Place)

*   **แสดงผลหน้าแรกและค้นหา (`HomePageView`):**
    *   หน้าแรกถูกออกแบบให้เป็น **Dynamic Dashboard** ที่ปรับเปลี่ยนเนื้อหาตามสถานะของผู้ใช้ และรองรับการค้นหาที่มีประสิทธิภาพ
    *   **การค้นหา:** ฟอร์มค้นหาด้านบนสุดของหน้าสามารถ:
        *   ค้นหาด้วยข้อความ (Text Search) จากชื่อ, คำอธิบาย, และที่ตั้งของสถานที่
        *   กรองตามหมวดหมู่ (Category Filter) ผ่าน Dropdown
        *   เมื่อมีการค้นหาเกิดขึ้น หน้าจะแสดงเฉพาะผลลัพธ์การค้นหา พร้อมระบบแบ่งหน้า (Paginator)
    *   **โครงสร้างหน้าแรก (เมื่อไม่มีการค้นหา):**
        *   **สำหรับผู้ใช้ที่ล็อกอิน (Authenticated):**
            1.  **แนะนำสำหรับคุณ (Recommended for You):** แสดงสถานที่แนะนำส่วนบุคคล 10 แห่งแรกจาก Hybrid Engine
            2.  **สถานที่ยอดนิยม (Popular Places):** แสดงสถานที่ที่ได้รับความนิยมสูงสุด 10 แห่ง
            3.  **สถานที่ใหม่ล่าสุด (Latest Places):** แสดงสถานที่ที่ถูกเพิ่มเข้ามาใหม่ 20 แห่ง
        *   **สำหรับผู้ใช้ทั่วไป (Anonymous):**
            1.  **สถานที่ยอดนิยม (Popular Places):** แสดง 10 อันดับแรก
            2.  **สถานที่ใหม่ล่าสุด (Latest Places):** แสดง 20 แห่งล่าสุด
    *   **ลิงก์ "ดูเพิ่มเติม" (View More):** ในแต่ละ Section (เช่น ยอดนิยม, ใหม่ล่าสุด) จะมีลิงก์ "ดูเพิ่มเติม" เพื่อนำผู้ใช้ไปยังหน้ารายการฉบับเต็มของหมวดหมู่นั้นๆ (`/places/popular/`, `/places/all/`) ซึ่งมีการแบ่งหน้าอย่างเหมาะสม

*   **ดูรายละเอียดสถานที่ (`PlaceDetailView`):**
    *   แสดงข้อมูลทั้งหมดของสถานที่, รูปภาพ, รีวิว, และความคิดเห็น
    *   มีการเพิ่ม `visit_count` ของสถานที่ และบันทึก `UserActivity` (ประเภท `view`) สำหรับผู้ใช้ที่ล็อกอิน (มีการป้องกันการนับซ้ำจากการรีเฟรชหน้า)
    *   แสดงผลว่าผู้ใช้ที่ล็อกอินอยู่เคยกดไลค์สถานที่นี้หรือไม่ (`user_liked_place`)
    *   แสดง **สถานที่ที่คล้ายกัน (Similar Places)** ซึ่งมาจากการคำนวณความคล้ายคลึงของเนื้อหา (`content-based`) โดย `recommendation_engine.get_similar_places()` และจะแสดงผลเหมือนกันสำหรับผู้ใช้ทุกคน (ไม่ใช่การแนะนำส่วนบุคคล)

*   **เพิ่ม/แก้ไข/ลบ สถานที่:**
    *   **Views:** `PlaceCreateView`, `PlaceUpdateView`, `PlaceDeleteView`
    *   **การตรวจสอบสิทธิ์:** `PlaceUpdateView` และ `PlaceDeleteView` ใช้ `OwnerOrStaffRequiredMixin`
    *   **การจัดการรูปภาพ:** `PlaceCreateView` และ `PlaceUpdateView` ใช้ `ImageHandlingMixin` ในการจัดการอัปโหลดรูปภาพ หนึ่งสถานที่อัปโหลดได้ไม่เกิน15รูป

### 3.2 การจัดการรีวิว (Review)

*   **Views:** `ReviewCreateView`, `ReviewUpdateView`, `ReviewDeleteView`
*   **การอัปเดตคะแนนเฉลี่ย:** เมื่อมีการสร้าง, แก้ไข, หรือลบรีวิว, `place.update_average_rating()` จะถูกเรียกใช้โดยอัตโนมัติผ่าน signal หรือ `save()` method ของ `Review` model เพื่อคำนวณคะแนนเฉลี่ยของสถานที่นั้นๆ ใหม่
*   **การตรวจสอบสิทธิ์:** `ReviewUpdateView` และ `ReviewDeleteView` ใช้ `OwnerOrStaffRequiredMixin`
*   **การจัดการรูปภาพ:** `ReviewCreateView` และ `ReviewUpdateView` ใช้ `ImageHandlingMixin` ในการจัดการอัปโหลดรูปภาพประกอบรีวิว (สูงสุด 5 รูป) เช่นเดียวกับการจัดการรูปภาพของสถานที่

### 3.3 การจัดการความคิดเห็น (Comment)

*   **Views:** `CommentCreateView`, `CommentUpdateView`, `CommentDeleteView`
*   **การตรวจสอบสิทธิ์:** `CommentUpdateView` และ `CommentDeleteView` ใช้ `OwnerOrStaffRequiredMixin`

---

## 4. ระบบปฏิสัมพันธ์, การติดตาม, และการรายงาน

### 4.1 การกดไลค์สถานที่ (`LikePlaceView`)

*   **View:** `LikePlaceView` (Class-Based View, ไม่ใช่ Function-based)
*   ใช้ `PlaceLike.objects.get_or_create()` เพื่อสร้างหรือลบ `PlaceLike` object (เป็นการ toggle)
*   มีการบันทึก `UserActivity` ประเภท `click` พร้อม `details` เป็น `{'action': 'like_place'}` หรือ `{'action': 'unlike_place'}`

### 4.2 การแชร์เนื้อหา (`RecordShareActivityView`)

*   **View:** `RecordShareActivityView` (Class-Based View)
*   JavaScript ที่หน้า `place_detail` จะส่ง `POST` request มาที่ View นี้ในเบื้องหลัง (background) เมื่อผู้ใช้คลิกปุ่มแชร์ เพื่อบันทึก `UserActivity` ประเภท `share` โดยที่หน้าเว็บไม่ต้องโหลดใหม่

### 4.3 การรายงานเนื้อหา (`BaseReportView` และ Subclasses)

*   **`BaseReportView`:** เป็น View แม่แบบที่จัดการตรรกะร่วมกันของการรายงาน
    *   มีการ **Refactor** เมธอด `get_success_url()` ให้ใช้ **Dictionary Mapping** แทน `if/elif` ทำให้โค้ดขยายต่อได้ง่ายเมื่อมี Report Type เพิ่มขึ้น
*   **Subclasses:** `ReportPlaceView`, `ReportReviewView`, `ReportCommentView` สืบทอดจาก `BaseReportView` เพื่อจัดการฟอร์มและการสร้าง `Report` object สำหรับเนื้อหาแต่ละประเภท

### 4.4 การติดตามกิจกรรมผู้ใช้ (`UserActivity` Model)

*   `UserActivity` model ใช้ **GenericForeignKey** (`content_type`, `object_id`) ทำให้สามารถเชื่อมโยงไปยัง Model ใดก็ได้
*   **`details` (JSONField):** ใช้เก็บข้อมูลเพิ่มเติมของแต่ละกิจกรรม เช่น:
    *   `search`: `{'query': 'คำค้นหา'}`
    *   `view`: `{'place_name': 'ชื่อสถานที่'}`
    *   `share`: `{'shared_to': 'facebook'}`
    *   `click`: `{'action': 'like_place'}`

---

## 5. ระบบแนะนำและส่วนของผู้ดูแลระบบ

### 5.1 ระบบแนะนำ (Recommendation System) - ภาพรวม

*   ระบบแนะนำถูกผนวกรวมเข้ากับส่วนต่างๆ ของเว็บอย่างชาญฉลาด และมีหน้าสำหรับแสดงผลโดยเฉพาะ:
    *   **หน้าแรก (`HomePageView`):** สำหรับผู้ใช้ที่ล็อกอิน จะแสดง **รายการแนะนำส่วนบุคคล (Personalized)** 10 แห่งจาก Hybrid Engine
    *   **หน้ารายละเอียดสถานที่ (`PlaceDetailView`):** แสดง **รายการสถานที่ที่คล้ายกัน (Content-Based)** เพื่อแนะนำตัวเลือกอื่นที่ใกล้เคียงกัน
    *   **หน้าแนะนำเฉพาะ (`/places/recommendations/`):** แสดงรายการแนะนำส่วนบุคคลทั้งหมด (50 แห่ง) สำหรับผู้ใช้ที่ล็อกอิน พร้อมระบบ Paginator
    *   **หน้ายอดนิยมเฉพาะ (`/places/popular/`):** แสดงรายการสถานที่ที่ได้รับความนิยมสูงสุดทั้งหมด (50 แห่ง) จาก `Popularity-Based Engine` พร้อมระบบ Paginator
*   (รายละเอียดเชิงลึกของ Engine แต่ละประเภทจะอยู่ในเอกสาร `recommendation_system_definitive_guide.md`)

### 5.2 แดชบอร์ดสำหรับผู้ดูแล (`AdminActivityView`)

*   **URL:** `/admin/activity/`
*   **View:** `AdminActivityView`
*   **Template:** `review/admin_activity.html`
*   **การเข้าถึง:** จำกัดเฉพาะผู้ใช้ที่เป็น Staff (`AdminActivityMixin` ตรวจสอบ `user.is_staff`)
*   **การ Refactor และการแสดงผลข้อมูล:**
    *   View นี้ถูกปรับโครงสร้างใหม่โดยใช้ Helper Methods (`_get_user_activity_data`, `_get_content_popularity_data`, etc.) เพื่อแยกตรรกะการประมวลผลข้อมูลสำหรับกราฟแต่ละส่วนออกจากกัน ทำให้โค้ดสะอาดและดูแลรักษาง่าย
    *   ข้อมูลที่ประมวลผลแล้วจะถูกส่งไปยัง Template ในรูปแบบ JSON เพื่อให้ Chart.js นำไปสร้างกราฟ 5 ประเภทดังนี้:
        1.  **User Activity Analysis (กราฟแท่ง):**
            *   **แสดงผล:** กราฟแท่งที่แกน X คือชื่อผู้ใช้ และแกน Y คือจำนวนกิจกรรม โดยแต่ละแท่งจะถูกแบ่งสีตามประเภทกิจกรรม (view, share, click, search)
            *   **ประโยชน์:** ช่วยให้ผู้ดูแลมองเห็นว่าผู้ใช้คนใดมีส่วนร่วมกับระบบมากที่สุด และมีพฤติกรรมเด่นในด้านใดเป็นพิเศษ (เช่น เป็นผู้ดู, ผู้แชร์, หรือผู้ค้นหา)
        2.  **Content Popularity (กราฟแท่งแนวนอน):**
            *   **แสดงผล:** กราฟแท่งแนวนอนที่จัดอันดับเนื้อหา (สถานที่และรีวิว) ที่ได้รับความนิยมสูงสุด 10 อันดับแรก โดยวัดจาก "จำนวนการเข้าชม (view) และการแชร์ (share) รวมกัน"
            *   **ประโยชน์:** ทำให้ทราบว่าเนื้อหาใดกำลังเป็นที่สนใจของผู้ใช้โดยรวม สามารถนำไปใช้ในการโปรโมทหรือวิเคราะห์เทรนด์ได้
        3.  **Sharing Behavior (กราฟวงกลม):**
            *   **แสดงผล:** กราฟวงกลมที่แสดงสัดส่วนของช่องทางโซเชียลมีเดียที่ผู้ใช้แชร์เนื้อหาไป (เช่น Facebook, X (Twitter), LINE, Direct Link)
            *   **ประโยชน์:** ช่วยให้เข้าใจว่าช่องทางการตลาดใดมีประสิทธิภาพสูงสุด และผู้ใช้ส่วนใหญ่นิยมแชร์ผ่านแพลตฟอร์มใด
        4.  **Time-Based Analysis (กราฟเส้น):**
            *   **แสดงผล:** กราฟเส้นที่แสดงแนวโน้มของ "จำนวนกิจกรรมทั้งหมด" ที่เกิดขึ้นในระบบตามช่วงเวลาที่ผู้ดูแลเลือก (รายวัน, รายเดือน, หรือรายปี)
            *   **ประโยชน์:** ใช้ติดตามการเติบโตของแพลตฟอร์ม, วิเคราะห์ช่วงเวลาที่มีการใช้งานสูงสุด (Peak Hours), และประเมินผลกระทบของแคมเปญต่างๆ
        5.  **Click Action Analysis (กราฟวงกลม):**
            *   **แสดงผล:** กราฟวงกลมที่จำแนกประเภทของการคลิกที่เกิดขึ้นในระบบ เช่น `like_place` หรือ `unlike_place`
            *   **ประโยชน์:** ช่วยให้เข้าใจพฤติกรรมการมีส่วนร่วมของผู้ใช้ในระดับที่ละเอียดขึ้น ว่าผู้ใช้มีแนวโน้มที่จะกดไลค์หรือยกเลิกการไลค์มากกว่ากัน
*   **การส่งออกข้อมูล:** มี `AdminActivityExportView` สำหรับส่งออกข้อมูลกิจกรรมในรูปแบบ CSV โดยอิงตาม Filter ที่ผู้ดูแลเลือกในหน้าแดชบอร์ด ทำให้สามารถนำข้อมูลไปวิเคราะห์ต่อในโปรแกรมอื่นได้

### 5.3 การปรับแต่งหน้า Admin (Admin Panel Customization)

นอกเหนือจากแดชบอร์ดแสดงกิจกรรมแล้ว หน้า Admin มาตรฐานของ Django ยังได้รับการปรับปรุงในไฟล์ `admin.py` เพื่อเพิ่มประสิทธิภาพในการจัดการข้อมูลหลังบ้าน:

*   **วัตถุประสงค์:** เพื่อให้ผู้ดูแลระบบสามารถค้นหา, กรอง, และตรวจสอบข้อมูลของโมเดลหลักๆ ได้อย่างรวดเร็วและสะดวกสบาย
*   **การปรับปรุงหลัก:**
    *   **`list_display`:** กำหนดฟิลด์สำคัญที่จะแสดงในหน้ารายการของแต่ละโมเดล เช่น สำหรับ `PlaceAdmin` จะแสดง `place_name`, `category`, `average_rating` ทำให้เห็นข้อมูลสรุปได้ทันทีโดยไม่ต้องคลิกเข้าไปดูรายละเอียด
    *   **`search_fields`:** เพิ่มกล่องค้นหาที่สามารถค้นหาข้อมูลจากฟิลด์ที่กำหนดไว้ เช่น ค้นหาสถานที่จากชื่อ (`place_name`) หรือคำอธิบาย (`description`)
    *   **`list_filter`:** เพิ่มแถบตัวกรองด้านข้างที่ช่วยให้สามารถกรองข้อมูลตามเงื่อนไขได้ง่าย เช่น กรอง `Review` ตาม `status` (เช่น 'published', 'pending') หรือ `rating`
    *   **`readonly_fields`:** ป้องกันการแก้ไขฟิลด์ที่คำนวณโดยอัตโนมัติ (เช่น `visit_count`, `total_reviews`) เพื่อรักษาความถูกต้องของข้อมูล

---

## 6. สถาปัตยกรรมฝั่ง Frontend และประสบการณ์ผู้ใช้ (Frontend & UX)

### 6.1 โครงสร้างพื้นฐาน `base.html` และ `form.html`

*   **`base.html`:** เป็นโครงสร้างหลักที่ใช้ CSS Framework 2 ตัวคือ **Bootstrap** และ **Tailwind CSS** มี Navigation Bar แบบไดนามิกที่แสดงผลต่างกันตามสถานะการล็อกอินและสิทธิ์ของผู้ใช้ (เช่น ผู้ดูแลระบบจะเห็นลิงก์ "Admin")
*   **`form.html`:** เป็นเทมเพลตกลางสำหรับฟอร์มทุกประเภท (`Login`, `Register`, `Place`, `Review`) ทำให้ทุกฟอร์มมีหน้าตาที่สอดคล้องกันโดยอัตโนมัติ ลดความซ้ำซ้อนของโค้ด

### 6.2 หัวใจของ UX ใน `place_detail.html`

หน้านี้ใช้ JavaScript เพื่อสร้างประสบการณ์ผู้ใช้ที่ดีและโต้ตอบได้ (Interactive):
*   **การกดไลค์ (`LikePlaceView`):** ส่ง `POST` request ไปยังเซิร์ฟเวอร์เพื่อบันทึกการกดไลค์ และ redirect กลับมายังหน้าเดิมเพื่ออัปเดตสถานะของปุ่ม (Like/Unlike)
*   **การแชร์ (`RecordShareActivityView`):** ใช้ `fetch` API เพื่อส่งข้อมูลการแชร์ (เช่น แชร์ไปที่ Facebook, Twitter) ไปบันทึกในเบื้องหลัง (Asynchronously) โดยที่หน้าเว็บไม่ต้องโหลดใหม่ ทำให้ UX ราบรื่น
*   **การคัดลอกลิงก์:** ใช้ JavaScript เพื่อคัดลอก URL ของสถานที่ลงใน Clipboard และเรียกใช้ฟังก์ชันบันทึกกิจกรรมการแชร์ไปพร้อมกัน
*   **การแสดง/ซ่อนความคิดเห็น:** ใช้ฟังก์ชัน JavaScript (`toggleComments`) เพื่อเปิด/ปิดการแสดงรายการความคิดเห็นของแต่ละรีวิว ช่วยให้หน้าเว็บไม่ยาวเกินไปและดูสะอาดตา

### 6.3 หน้าโปรไฟล์ `profile.html`

*   **คำอธิบายที่ถูกต้อง:** หน้า `profile.html` เป็นเพียงหน้า **แสดงข้อมูล (Display Page)** ที่เรียบง่าย แสดงข้อมูลส่วนตัวของผู้ใช้ที่ล็อกอินอยู่ และมีปุ่มลิงก์ 2 ปุ่มคือ "แก้ไขโปรไฟล์" และ "เปลี่ยนรหัสผ่าน" ซึ่งจะนำผู้ใช้ไปยังหน้าฟอร์มแยกต่างหาก (`ProfileUpdateView`, `CustomPasswordChangeView`)

### 6.4 แดชบอร์ดผู้ดูแล `admin_activity.html`

*   **การแสดงผลกราฟ:** ใช้ไลบรารี **Chart.js** เพื่อวาดกราฟ 5 ประเภทตามข้อมูล JSON ที่ส่งมาจาก `AdminActivityView` ทำให้ผู้ดูแลระบบเห็นภาพรวมของกิจกรรมในระบบได้ง่าย
*   **การส่งออกข้อมูล:** ฟอร์ม Export มีการใช้ `<input type="hidden">` เพื่อส่งค่า Filter ปัจจุบัน (เช่น ประเภทกิจกรรม, ช่วงเวลา) ไปพร้อมกับ `POST` request เพื่อให้ Backend สามารถส่งออกข้อมูลที่ถูกต้องในรูปแบบไฟล์ CSV ได้

---
